{% extends 'base.html' %} {% load static %} {% block css %}

<style>
  .cnav-item {
    margin-right: 23%;
  }
  h6{
    font-size: 18px;
  }
</style>

{% endblock %} 

{% block content %}

<div class="d-flex container-fluid">
  <h2 class="cnav-item fs-6">Stage</h2>
  <h2 class="cnav-item fs-6">Campaign</h2>
  <h2 class="cnav-item fs-6">Route</h2>
  <h2 class="cnav-item fs-6">Client</h2>
</div>

<div class="container-fluid pt-2">
  <div class="row">
    <div class="card p-0">
      <div class="card-body p-3 m-0">
        <div class="row">
          <div class="col-sm-4 mb-sm-0">
            <div class="card m-0">
              <div class="card-body">
                <h6> <b> Name : </b> {{customer.first_name}} {{customer.last_name}}</h6>
                <h6> <b> Telephone : </b> {{customer.phone_number}}</h6>
                <h6> <b> Email: </b> {{customer.email}}</h6>
              </div>
            </div>
          </div>

          <div class="col-sm-4">
            <div class="card m-0">
              <div class="card-body">
                <h6>Address : {{customer.address}}</h6>
                <h6>Postcode : {{customer.postcode}}</h6>
              </div>
            </div>
          </div>

          <div class="col-sm-4">
            <div class="card m-0">
              <div class="card-body">
                <h6>Local Authority</h6>
                <h6>Managed by</h6>
                <h6 style="color: white">Postcode</h6>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    {% for message in messages %}
            <div class="alert {{ message.tags }} alert-dismissible fade show" role="alert">
                  {{ message }}
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
          {% endfor %}
    <form id="action_submit_form" method="post" action="{% url 'app:action_submit' customer.id %}">
      {% csrf_token %}
    <div class="card p-0">
      <div class="card-body p-3 m-0">
        <div class="row">
          <div class="col-sm-6 mb-3 mb-sm-0">
            <div class="card m-0">
              <div class="card-body m-0">
                <h6>Next Action: {% with latest_action=customer.get_action_history.first %}
                  {{ latest_action.date_time }}
                {% endwith %}</h6>
                <div class="d-grid gap-2 d-md-block mt-3">
                  <button class="btn btn-primary" type="button">NA</button>
                  <button class="btn btn-primary" type="button">
                    Call Back
                  </button>
                </div>
                <div class="form-floating">
                  <textarea
                    class="form-control mt-3"
                    placeholder="Leave a comment here"
                    id="floatingTextarea2"
                    style="height: 100px"
                    name="text"
                  ></textarea>
                  <label for="floatingTextarea2">Comments</label>
                </div>
                <div class="form-floating p-2">
                  <label for="date_field">Date</label>
                  <input type="date" id="date_field" name="date_field" class="form-control" data-target="#datetimepicker1" required>
                </div>
                  <div class="form-floating p-2">
                    <label for="time_field">Time</label>
                    <input type="time" id="time_field" name="time_field" class="form-control" data-target="#datetimepicker1" required>
                  </div>
                <div class="d-flex justify-content-end mt-3">
                  <div class="d-grid gap-2 d-md-block">
                    <button class="btn btn-primary" type="submit">
                      Submit
                    </button>
                  </div>
                </div>
              </form>
                <h6>History</h6>
                <div class="card p-0 m-0">
                  <div class="card-body p-3 m-0" style="height: 150px; overflow-y: auto;">
                    {% for action in customer.get_action_history %}
                      <p> <b>{{ action.date_time }} </b> - {{ action.text }}</p>
                    {% endfor %}
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="col-sm-6">
            <div class="card m-0">
              <div class="card-body">
                <div class="d-grid gap-2 d-md-block">
                  <button class="btn btn-primary" type="button">Action Required</button>
                </div>
                <div class="card p-0 m-0">
                  <div class="card-body p-3 m-0"  style="height: 390px" >

                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

{% endblock %}
